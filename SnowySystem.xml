<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Include file="SnowySystem.lua"/>
  <Include file="Shared.lua"/>
  <Include file="DrawElements.lua"/>
  <Include file="Config.lua"/>
  <Frame name="SS_Player_Menu" parent="UIParent" enableMouse="true">
    <Scripts>
      <OnLoad>
        self:RegisterEvent("ADDON_LOADED");
      </OnLoad>
			<OnEvent>
        if(event == "ADDON_LOADED") then
          SS_ApplicationLoad();
          if (SS_User.settings.currentPlot) then
            SS_ResizePlayerMenuOnPlotActivate();
          else
            SS_ResizePlayerMenuOnPlotDeactivate();
          end;
        end;
      </OnEvent>
      <OnUpdate>
      </OnUpdate>
      <OnEnter>
        self:SetPoint("LEFT", -12, 0);
      </OnEnter>
      <OnLeave>
        self:SetPoint("LEFT", -64, 0);
      </OnLeave>
    </Scripts>
    <Size>
      <AbsDimension x="84" y="84" />
    </Size>
    <Anchors>
      <Anchor point="LEFT">
        <Offset><AbsDimension x="-64" y="0"/></Offset>
      </Anchor>
    </Anchors>
    <Backdrop bgFile="Interface\DialogFrame\UI-DialogBox-Background" edgeFile="Interface\DialogFrame\UI-DialogBox-Border" tile="true">
      <BackgroundInsets>
        <AbsInset left="8" right="8" top="8" bottom="8"/>
      </BackgroundInsets>
      <TileSize>
        <AbsValue val="32"/>
      </TileSize>
      <EdgeSize>
        <AbsValue val="32"/>
      </EdgeSize>
    </Backdrop>
    <Frames>
      <Button name="$parent_StatsIcon">
        <Scripts>
          <OnEnter>
            SS_Player_Menu:SetPoint("LEFT", -12, 0);
            GameTooltip:SetOwner(this, "CENTER")
            GameTooltip:AddLine("Характеристики")
            GameTooltip:Show()
          </OnEnter>
          <OnLeave>
            SS_Player_Menu:SetPoint("LEFT", -64, 0);
            GameTooltip:Hide()
          </OnLeave>
          <OnClick>
            if (SS_Stats_Menu:IsVisible()) then
              SS_Stats_Menu:Hide();
            else
              SS_HideAllSubmenus();
              SS_Stats_Menu:Show();
            end;
          </OnClick>
        </Scripts>
        <Anchors>
          <Anchor point="TOP">
            <Offset>
              <AbsDimension x="0" y="-20"/>
            </Offset>
          </Anchor>
        </Anchors>
        <Size>
          <AbsDimension x="32" y="32" />
        </Size>
        <NormalTexture file = "Interface\AddOns\SnowySystem\IMG\stats.blp" />
      </Button>
      <Button name="$parent_SkillsIcon">
        <Scripts>
          <OnEnter>
            SS_Player_Menu:SetPoint("LEFT", -12, 0);
            GameTooltip:SetOwner(this, "CENTER")
            GameTooltip:AddLine("Навыки")
            GameTooltip:Show()
          </OnEnter>
          <OnLeave>
            SS_Player_Menu:SetPoint("LEFT", -64, 0);
            GameTooltip:Hide()
          </OnLeave>
          <OnClick>
            if (SS_Controll_Menu:IsVisible()) then
              SS_Controll_Menu:Hide();
            else
              SS_HideAllSubmenus();
              SS_Controll_Menu:Show();
            end;
          </OnClick>
        </Scripts>
        <Anchors>
          <Anchor point="CENTER" />
        </Anchors>
        <Size>
          <AbsDimension x="32" y="32" />
        </Size>
        <NormalTexture file = "Interface\AddOns\SnowySystem\IMG\skills.blp" />
      </Button>
      <Button name="$parent_SettingsIcon">
        <Scripts>
          <OnEnter>
            SS_Player_Menu:SetPoint("LEFT", -12, 0);
            GameTooltip:SetOwner(this, "CENTER")
            GameTooltip:AddLine("Управление")
            GameTooltip:Show()
          </OnEnter>
          <OnLeave>
            SS_Player_Menu:SetPoint("LEFT", -64, 0);
            GameTooltip:Hide()
          </OnLeave>
          <OnClick>
            if (SS_Controll_Menu:IsVisible()) then
              SS_Controll_Menu:Hide();
            else
              SS_HideAllSubmenus();
              SS_Controll_Menu:Show();
            end;
          </OnClick>
        </Scripts>
        <Anchors>
          <Anchor point="CENTER" />
        </Anchors>
        <Size>
          <AbsDimension x="32" y="32" />
        </Size>
        <NormalTexture file = "Interface\AddOns\SnowySystem\IMG\settings_normal" />
      </Button>
    </Frames>
  </Frame>
  <Frame name="SS_Controll_Menu" hidden="true">
    <Scripts>
      <OnShow>
        SS_DrawPlots(SS_Controll_Menu_Settings_PlotType:GetText())
      </OnShow>
    </Scripts>
    <Size><AbsDimension x="500" y="250"/></Size>
    <Anchors>
      <Anchor point="LEFT" relativeTo="SS_Player_Menu">
      <Offset><AbsDimension x="57" y="0"/></Offset>
      </Anchor>
    </Anchors>
    <Backdrop bgFile="Interface\DialogFrame\UI-DialogBox-Background" edgeFile="Interface\DialogFrame\UI-DialogBox-Border" tile="true">
      <BackgroundInsets>
        <AbsInset left="8" right="8" top="8" bottom="8"/>
      </BackgroundInsets>
      <TileSize>
        <AbsValue val="32"/>
      </TileSize>
      <EdgeSize>
        <AbsValue val="32"/>
      </EdgeSize>
    </Backdrop>
    <Layers>
      <Layer>
        <FontString name="$parent_Title" font="Fonts\FRIZQT__.TTF" text="Управление">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="12"/>
          <Anchors>
            <Anchor point="TOP" x="0" y="-20" />
          </Anchors>
        </FontString>
      </Layer>
      <Layer>
        <FontString name="$parent_SettingsTitle" font="Fonts\FRIZQT__.TTF" text="Настройки">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="20" y="-48" />
          </Anchors>
        </FontString>
        <FontString name="$parent_PlotsTitle" font="Fonts\FRIZQT__.TTF" text="Сюжеты">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOP" x="-14" y="-48" />
          </Anchors>
        </FontString>
      </Layer>
      <Layer>
        <FontString name="$parent_Settings_DiceInfo" font="Fonts\FRIZQT__.TTF" text="Информация о броске">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="40" y="-76" />
          </Anchors>
        </FontString>
        <FontString name="$parent_Settings_Invites" font="Fonts\FRIZQT__.TTF" text="Принимать приглашения">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="40" y="-106" />
          </Anchors>
        </FontString>
        <FontString name="$parent_Settings_PlotType" font="Fonts\FRIZQT__.TTF" text="Участник">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPRIGHT" x="-50" y="-48" />
          </Anchors>
        </FontString>
        <FontString name="$parent_Settings_EmptyPlot" font="Fonts\FRIZQT__.TTF">
          <Color r="0.6" g="0.6" b="0.6" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPRIGHT" x="-174" y="-76" />
          </Anchors>
        </FontString>
      </Layer>
    </Layers>
    <Frames>
      <CheckButton name="$parent_Settings_DiceCheck" inherits="OptionsCheckButtonTemplate" checked="true">
        <Anchors>
          <Anchor point="TOPLEFT">
            <Offset>
              <AbsDimension x="14" y="-70"></AbsDimension>
            </Offset>
          </Anchor>
        </Anchors>
      </CheckButton>
      <CheckButton name="$parent_Settings_InvitesCheck" inherits="OptionsCheckButtonTemplate" checked="true">
        <Anchors>
          <Anchor point="TOPLEFT">
            <Offset>
              <AbsDimension x="14" y="-100"></AbsDimension>
            </Offset>
          </Anchor>
        </Anchors>
      </CheckButton>
      <Button name="$parent_Settings_PlotTypeNext" inherits="OptionsButtonTemplate" text="+">
        <Size x = "20" y = "20" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-20" y="-43"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnShow>
            if (SS_Controll_Menu_Settings_PlotType:GetText() == "Участник") then
              SS_HideEmptyPlotsText('plots');
            else
              SS_HideEmptyPlotsText('leadingPlots');
            end;
          </OnShow>
          <OnClick>
            if (SS_Controll_Menu_Settings_PlotType:GetText() == "Участник") then
              SS_Controll_Menu_Settings_PlotType:SetText("Ведущий");
              SS_Controll_Menu_Settings_Create_New_Plot:Show();
              SS_HideEmptyPlotsText('leadingPlots');
            else
              SS_Controll_Menu_Settings_PlotType:SetText("Участник");
              SS_Controll_Menu_Settings_Create_New_Plot:Hide();
              SS_HideEmptyPlotsText('plots');
            end;
            SS_DrawPlots(SS_Controll_Menu_Settings_PlotType:GetText());
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Settings_Create_New_Plot" hidden="true" inherits="OptionsButtonTemplate" text="Создать">
        <Anchors>
          <Anchor point="BOTTOMRIGHT">
            <Offset x="-20" y="24"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            self:GetParent():Hide();
            SS_Create_Menu:Show();
          </OnClick>
        </Scripts>
      </Button>
      <Frame name="SS_Plots_Container">
        <Size><AbsDimension x="300" y="140"/></Size>
        <Anchors>
          <Anchor point="RIGHT" relativeTo="SS_Controll_Menu">
          <Offset><AbsDimension x="0" y="0"/></Offset>
          </Anchor>
        </Anchors>
      </Frame>
    </Frames>
  </Frame>
  <Frame name="SS_Stats_Menu" hidden="true">
    <Scripts>
      <OnShow>
        SS_Stats_Menu_Stat_Power_Value:SetText(SS_User.plots[SS_User.settings.currentPlot].stats.power);
        SS_Stats_Menu_Stat_Vigilance_Value:SetText(SS_User.plots[SS_User.settings.currentPlot].stats.vigilance);
        SS_Stats_Menu_Stat_Wisdom_Value:SetText(SS_User.plots[SS_User.settings.currentPlot].stats.wisdom);
        SS_Stats_Menu_Stat_Reaction_Value:SetText(SS_User.plots[SS_User.settings.currentPlot].stats.reaction);
        SS_Stats_Menu_Stat_Empathy_Value:SetText(SS_User.plots[SS_User.settings.currentPlot].stats.empathy);
        SS_Stats_Menu_Stat_Stamina_Value:SetText(SS_User.plots[SS_User.settings.currentPlot].stats.stamina);
      </OnShow>
    </Scripts>
    <Size><AbsDimension x="200" y="215"/></Size>
    <Anchors>
      <Anchor point="LEFT" relativeTo="SS_Player_Menu">
      <Offset><AbsDimension x="57" y="0"/></Offset>
      </Anchor>
    </Anchors>
    <Backdrop bgFile="Interface\DialogFrame\UI-DialogBox-Background" edgeFile="Interface\DialogFrame\UI-DialogBox-Border" tile="true">
      <BackgroundInsets>
        <AbsInset left="8" right="8" top="8" bottom="8"/>
      </BackgroundInsets>
      <TileSize>
        <AbsValue val="32"/>
      </TileSize>
      <EdgeSize>
        <AbsValue val="32"/>
      </EdgeSize>
    </Backdrop>
    <Layers>
      <Layer>
        <FontString name="$parent_Title" font="Fonts\FRIZQT__.TTF" text="Характеристики">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="12"/>
          <Anchors>
            <Anchor point="TOP" x="0" y="-20" />
          </Anchors>
          <Shadow>
            <Offset x="-1" y="-1" />
            <Color r="0" g="0" b="0"/>
          </Shadow>
        </FontString>
      </Layer>
      <Layer>
        <FontString name="$parent_Stat_Power_Name" font="Fonts\FRIZQT__.TTF" text="Мощь:">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="20" y="-45" />
          </Anchors>
        </FontString>
        <FontString name="$parent_Stat_Vigilance_Name" font="Fonts\FRIZQT__.TTF" text="Зоркость:">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="20" y="-70" />
          </Anchors>
        </FontString>
        <FontString name="$parent_Stat_Wisdom_Name" font="Fonts\FRIZQT__.TTF" text="Мудрость:">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="20" y="-95" />
          </Anchors>
        </FontString>
        <FontString name="$parent_Stat_Reaction_Name" font="Fonts\FRIZQT__.TTF" text="Реакция:">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="20" y="-120" />
          </Anchors>
        </FontString>
        <FontString name="$parent_Stat_Empathy_Name" font="Fonts\FRIZQT__.TTF" text="Эмпатия:">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="20" y="-145" />
          </Anchors>
        </FontString>
        <FontString name="$parent_Stat_Stamina_Name" font="Fonts\FRIZQT__.TTF" text="Стойкость:">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="20" y="-170" />
          </Anchors>
        </FontString>
      </Layer>
      <Layer>
        <FontString name="$parent_Stat_Power_Value" font="Fonts\FRIZQT__.TTF" text="0">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="57" y="-45" />
          </Anchors>
        </FontString>
        <FontString name="$parent_Stat_Vigilance_Value" font="Fonts\FRIZQT__.TTF" text="0">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="75" y="-70" />
          </Anchors>
        </FontString>
        <FontString name="$parent_Stat_Wisdom_Value" font="Fonts\FRIZQT__.TTF" text="0">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="77" y="-95" />
          </Anchors>
        </FontString>
        <FontString name="$parent_Stat_Reaction_Value" font="Fonts\FRIZQT__.TTF" text="0">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="70" y="-120" />
          </Anchors>
        </FontString>
        <FontString name="$parent_Stat_Empathy_Value" font="Fonts\FRIZQT__.TTF" text="0">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="70" y="-145" />
          </Anchors>
        </FontString>
        <FontString name="$parent_Stat_Stamina_Value" font="Fonts\FRIZQT__.TTF" text="0">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="TOPLEFT" x="79" y="-170" />
          </Anchors>
        </FontString>
      </Layer>
    </Layers>
    <Frames>
      <Button name="$parent_Stat_Power_Add" inherits="OptionsButtonTemplate" text="+">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-76" y="-43"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(1, 'power', SS_Stats_Menu_Stat_Power_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Power_Reduce" inherits="OptionsButtonTemplate" text="-">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-56" y="-43"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(-1, 'power', SS_Stats_Menu_Stat_Power_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Power_Reset" inherits="OptionsButtonTemplate" text="x">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-36" y="-43"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(-SS_User.plots[SS_User.settings.currentPlot].stats.power, 'power', SS_Stats_Menu_Stat_Power_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Power_Info" inherits="OptionsButtonTemplate" text="?">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-16" y="-43"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            self:GetParent():Hide()
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Vigilance_Add" inherits="OptionsButtonTemplate" text="+">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-76" y="-68"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(1, 'vigilance', SS_Stats_Menu_Stat_Vigilance_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Vigilance_Reduce" inherits="OptionsButtonTemplate" text="-">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-56" y="-68"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(-1, 'vigilance', SS_Stats_Menu_Stat_Vigilance_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Vigilance_Reset" inherits="OptionsButtonTemplate" text="x">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-36" y="-68"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(-SS_User.plots[SS_User.settings.currentPlot].stats.vigilance, 'vigilance', SS_Stats_Menu_Stat_Vigilance_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Vigilance_Info" inherits="OptionsButtonTemplate" text="?">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-16" y="-68"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            self:GetParent():Hide()
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Wisdom_Add" inherits="OptionsButtonTemplate" text="+">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-76" y="-93"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(1, 'wisdom', SS_Stats_Menu_Stat_Wisdom_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Wisdom_Reduce" inherits="OptionsButtonTemplate" text="-">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-56" y="-93"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(-1, 'wisdom', SS_Stats_Menu_Stat_Wisdom_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Wisdom_Reset" inherits="OptionsButtonTemplate" text="x">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-36" y="-93"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(-SS_User.plots[SS_User.settings.currentPlot].stats.wisdom, 'wisdom', SS_Stats_Menu_Stat_Wisdom_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Wisdom_Info" inherits="OptionsButtonTemplate" text="?">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-16" y="-93"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            self:GetParent():Hide()
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Reaction_Add" inherits="OptionsButtonTemplate" text="+">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-76" y="-118"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(1, 'reaction', SS_Stats_Menu_Stat_Reaction_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Reaction_Reduce" inherits="OptionsButtonTemplate" text="-">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-56" y="-118"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(-1, 'reaction', SS_Stats_Menu_Stat_Reaction_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Reaction_Reset" inherits="OptionsButtonTemplate" text="x">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-36" y="-118"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(-SS_User.plots[SS_User.settings.currentPlot].stats.reaction, 'reaction', SS_Stats_Menu_Stat_Reaction_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Reaction_Info" inherits="OptionsButtonTemplate" text="?">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-16" y="-118"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            self:GetParent():Hide()
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Empathy_Add" inherits="OptionsButtonTemplate" text="+">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-76" y="-143"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(1, 'empathy', SS_Stats_Menu_Stat_Empathy_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Empathy_Reduce" inherits="OptionsButtonTemplate" text="-">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-56" y="-143"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(-1, 'empathy', SS_Stats_Menu_Stat_Empathy_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Empathy_Reset" inherits="OptionsButtonTemplate" text="x">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-36" y="-143"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(-SS_User.plots[SS_User.settings.currentPlot].stats.empathy, 'empathy', SS_Stats_Menu_Stat_Empathy_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Empathy_Info" inherits="OptionsButtonTemplate" text="?">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-16" y="-143"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            self:GetParent():Hide()
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Stamina_Add" inherits="OptionsButtonTemplate" text="+">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-76" y="-168"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(1, 'stamina', SS_Stats_Menu_Stat_Stamina_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Stamina_Reduce" inherits="OptionsButtonTemplate" text="-">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-56" y="-168"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(-1, 'stamina', SS_Stats_Menu_Stat_Stamina_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Stamina_Reset" inherits="OptionsButtonTemplate" text="x">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-36" y="-168"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            SS_PointToStat(-SS_User.plots[SS_User.settings.currentPlot].stats.stamina, 'stamina', SS_Stats_Menu_Stat_Stamina_Value);
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Stat_Stamina_Info" inherits="OptionsButtonTemplate" text="?">
        <Size x = "14" y = "16" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-16" y="-168"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            self:GetParent():Hide()
          </OnClick>
        </Scripts>
      </Button>
    </Frames>
  </Frame>
  <Frame name="SS_Create_Menu" parent = "UIParent" hidden="true">
    <Size><AbsDimension x="300" y="164"/></Size>
    <Anchors>
      <Anchor point="CENTER" />
    </Anchors>
    <Backdrop bgFile="Interface\AddOns\SnowySystem\IMG\create-menu-background" edgeFile="Interface\DialogFrame\UI-DialogBox-Border" tile="true">
      <BackgroundInsets>
        <AbsInset left="8" right="8" top="8" bottom="8"/>
      </BackgroundInsets>
      <TileSize>
        <AbsValue val="300"/>
      </TileSize>
      <EdgeSize>
        <AbsValue val="32"/>
      </EdgeSize>
    </Backdrop>
    <Layers>
      <Layer>
        <FontString name="$parent_Title" font="Fonts\FRIZQT__.TTF" text="Новый сюжет">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="14"/>
          <Anchors>
            <Anchor point="TOP" x="0" y="-20" />
          </Anchors>
          <Shadow>
            <Offset x="-1" y="-1" />
            <Color r="0" g="0" b="0"/>
          </Shadow>
        </FontString>
        <FontString name="$parent_Name_Input_Title" font="Fonts\FRIZQT__.TTF" text="Название:">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="11"/>
          <Anchors>
            <Anchor point="LEFT" x="52" y="36" />
          </Anchors>
          <Shadow>
            <Offset x="-1" y="-1" />
            <Color r="0" g="0" b="0"/>
          </Shadow>
        </FontString>
      </Layer>
    </Layers>
    <Frames>
      <Button name="$parent_Close_Button" inherits="OptionsButtonTemplate" text="x">
        <Size x = "20" y = "20" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-20" y="-20"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            self:GetParent():Hide()
          </OnClick>
        </Scripts>
      </Button>
      <EditBox name="$parent_Name_Input" letters="36" autoFocus="false">
        <Size x="200" y="36" />
        <Anchors>
          <Anchor point="CENTER">
            <Offset><AbsDimension x="0" y="8"/></Offset>
          </Anchor>
        </Anchors>
        <TextInsets top="4" bottom="4" left="8" right="8" />
        <Backdrop bgFile="Interface\DialogFrame\UI-DialogBox-Background" edgeFile="Interface\DialogFrame\UI-DialogBox-Border" tile="true">
          <EdgeSize>
            <AbsValue val="12"/>
          </EdgeSize>
        </Backdrop>
        <FontString inherits="ChatFontNormal" />
      </EditBox>
      <Button name="$parent_Close_Button" inherits="OptionsButtonTemplate" text="Создать">
        <Size x = "140" y = "36" />
        <Anchors>
          <Anchor point="BOTTOM">
            <Offset x="0" y="20"/>
          </Anchor>
        </Anchors>
        <Scripts>
          <OnClick>
            SS_createPlot(SS_Create_Menu_Name_Input:GetText(), UnitName("player"));
            self:GetParent():Hide();
          </OnClick>
        </Scripts>
      </Button>
    </Frames>
  </Frame>
  <Frame name="SS_Plot_Activate" parent = "UIParent" hidden="true">
    <Size><AbsDimension x="300" y="200"/></Size>
    <Scripts>
      <OnShow>
        SS_Plot_Activate_Name:SetText('"'..SS_GetPlotSummary("selected").name..'"');
        if (SS_User.plots[SS_User.settings.selectedPlot] and SS_User.leadingPlots[SS_User.settings.selectedPlot]) then
          SS_Plot_Activate_Role:SetText('Вы - игрок и ведущий сюжета');
        else
          if (SS_User.plots[SS_User.settings.selectedPlot]) then
            SS_Plot_Activate_Role:SetText('Вы - участник сюжета');
          elseif (SS_User.leadingPlots[SS_User.settings.selectedPlot]) then
            SS_Plot_Activate_Role:SetText('Вы - ведущий сюжета');
          end;
        end;
      </OnShow>
    </Scripts>
    <Anchors>
      <Anchor point="CENTER" />
    </Anchors>
    <Backdrop bgFile="Interface\AddOns\SnowySystem\IMG\player-activate" edgeFile="Interface\DialogFrame\UI-DialogBox-Border" tile="true">
      <BackgroundInsets>
        <AbsInset left="8" right="8" top="8" bottom="8"/>
      </BackgroundInsets>
      <TileSize>
        <AbsValue val="300"/>
      </TileSize>
      <EdgeSize>
        <AbsValue val="32"/>
      </EdgeSize>
    </Backdrop>
    <Layers>
      <Layer>
        <FontString name="$parent_PreName" font="Fonts\FRIZQT__.TTF" text = "Сюжет">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="16"/>
          <Anchors>
            <Anchor point="CENTER" x="0" y="50" />
          </Anchors>
          <Shadow>
            <Offset x="-1" y="-1" />
            <Color r="0" g="0" b="0"/>
          </Shadow>
        </FontString>
        <FontString name="$parent_Name" font="Fonts\FRIZQT__.TTF">
          <Color r="1" g="0.6" b="0" a="1"/>
          <FontHeight val="20"/>
          <Anchors>
            <Anchor point="CENTER" x="0" y="20" />
          </Anchors>
          <Shadow>
            <Offset x="-1" y="-1" />
            <Color r="0" g="0" b="0"/>
          </Shadow>
        </FontString>
        <FontString name="$parent_Role" font="Fonts\FRIZQT__.TTF" text="">
          <Color r="1" g="1" b="1" a="1"/>
          <FontHeight val="14"/>
          <Anchors>
            <Anchor point="CENTER" x="0" y="-10" />
          </Anchors>
          <Shadow>
            <Offset x="-1" y="-1" />
            <Color r="0" g="0" b="0"/>
          </Shadow>
        </FontString>
      </Layer>
    </Layers>
    <Frames>
      <Button name="$parent_Close_Button" inherits="OptionsButtonTemplate" text="x">
        <Size x = "20" y = "20" />
        <Anchors>
          <Anchor point="TOPRIGHT">
            <Offset x="-20" y="-20"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            self:GetParent():Hide()
            SS_User.settings.selectedPlot = nil;
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Remove_Button" inherits="OptionsButtonTemplate" text="Удалить">
        <Size x = "80" y = "30" />
        <Anchors>
          <Anchor point="BOTTOMLEFT">
            <Offset x="20" y="20"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            if (SS_User.settings.currentPlot == SS_User.settings.selectedPlot) then
              SS_User.settings.currentPlot = nil;
            end;
            SS_User.plots[SS_User.settings.selectedPlot] = nil;
            SS_User.leadingPlots[SS_User.settings.selectedPlot] = nil;
            SS_MakePlotSelected(nil);
            self:GetParent():Hide()
          </OnClick>
        </Scripts>
      </Button>
      <Button name="$parent_Activate_Button" inherits="OptionsButtonTemplate">
        <Size x = "110" y = "30" />
        <Anchors>
          <Anchor point="BOTTOMRIGHT">
            <Offset x="-20" y="20"/>
          </Anchor> 
        </Anchors>
        <Scripts>
          <OnClick>
            if (SS_User.settings.currentPlot == SS_User.settings.selectedPlot) then
              SS_MakePlotCurrent(nil);
              SS_ResizePlayerMenuOnPlotDeactivate();
            else
              SS_MakePlotCurrent(SS_User.settings.selectedPlot);
              SS_ResizePlayerMenuOnPlotActivate();
            end;
            SS_MakePlotSelected(nil);
            self:GetParent():Hide()
          </OnClick>
          <OnShow>
            if (SS_User.settings.currentPlot == SS_User.settings.selectedPlot) then
              SS_Plot_Activate_Activate_Button:SetText("Деактивировать");
            else
              SS_Plot_Activate_Activate_Button:SetText("Активировать");
            end;
          </OnShow>
        </Scripts>
      </Button>
    </Frames>
  </Frame>
</Ui>